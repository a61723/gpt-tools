<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin>
    <id>com.github.zjh7890.gpttools</id>
    <name>gpt-tools</name>
    <vendor>zjh7890</vendor>

    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.lang</depends>
    <depends>com.intellij.modules.java</depends>
<!--    <depends>com.intellij.json</depends>-->
<!--    <depends>com.intellij.modules.vcs</depends>-->
    <depends>Git4Idea</depends>

    <description></description>

    <resource-bundle>messages.MyBundle</resource-bundle>

    <extensions defaultExtensionNs="com.intellij">
        <!-- mapper.xml文件属性提示 -->
        <dom.fileMetaData id="baomidou.MapperDescription"
                          rootTagName="mapper"
                          implementation="com.baomidou.plugin.idea.mybatisx.dom.description.MapperDescription"/>
        <!-- mybatis配置文件属性提示 -->
        <dom.fileMetaData id="baomidou.ConfigurationDescription"
                          rootTagName="configuration"
                          implementation="com.baomidou.plugin.idea.mybatisx.dom.description.ConfigurationDescription"/>

        <intentionAction>
            <className>com.github.zjh7890.gpttools.actions.FixThisChunkAction</className>
        </intentionAction>

        <intentionAction>
            <className>com.github.zjh7890.gpttools.actions.ChatWithThisAction</className>
        </intentionAction>

<!--        <intentionAction>-->
<!--            <className>com.github.zjh7890.gpttools.actions.CompleteThisAction</className>-->
<!--        </intentionAction>-->

        <toolWindow id="LLMChat"
                    anchor="right"
                    factoryClass="com.github.zjh7890.gpttools.toolWindow.llmChat.LLMChatToolWindowFactory"
                    canCloseContents="false"
                    icon="/icons/icon_16px.svg">
            <title>LLm Chat Code</title>
        </toolWindow>
        
        <toolWindow id="GptFileTree"
                    anchor="right"
                    factoryClass="com.github.zjh7890.gpttools.toolWindow.treePanel.GptToolsContextToolWindowFactory"
                    canCloseContent="false"
                    canWorkInDumbMode="false"
                    icon="/icons/icon_dark_16px.svg">
        </toolWindow>

<!--        <toolWindow id="SearchToolWindowFactory" anchor="right" factoryClass="com.github.zjh7890.gpttools.toolWindow.search.SearchToolWindowFactory" />-->
        <projectService serviceImplementation="com.github.zjh7890.gpttools.services.ToolsService"/>
        <projectService serviceImplementation="com.github.zjh7890.gpttools.services.ChatCodingService"/>
        <projectService serviceImplementation="com.github.zjh7890.gpttools.utils.LLMCoroutineScope"/>

        <applicationConfigurable instance="com.github.zjh7890.gpttools.settings.GptToolsConfigurable" parentId="tools"/>

<!--        <applicationConfigurable instance="com.github.zjh7890.gpttools.settings.llmSettings.GptToolSettingsConfigurable"-->
<!--                                 id="com.github.zjh7890.gpttools.settings.llmSettings.GptToolSettingsConfigurable"-->
<!--                                 displayName="GptToolLlm"/>-->

<!--        <applicationConfigurable instance="com.example.plugin.MyPluginConfigurable"/>-->
    </extensions>

    <extensions defaultExtensionNs="com.gpttools">
        <shireLlmProvider implementation="com.github.zjh7890.gpttools.llm.impl.OpenAILikeProvider"/>
    </extensions>

<!--    <extensionPoints>-->
<!--        <extensionPoint qualifiedName="com.gpttools.shireLlmProvider"-->
<!--                        interface="com.github.zjh7890.gpttools.llm.LlmProvider"-->
<!--                        dynamic="true"/>-->
<!--    </extensionPoints>-->

    <applicationListeners>
<!--        <listener class="com.github.zjh7890.gpttools.listeners.MyApplicationActivationListener" topic="com.intellij.openapi.application.ApplicationActivationListener"/>-->
    </applicationListeners>

    <actions>
        <group id="PromptGeneratorGroup"
               class="com.github.zjh7890.gpttools.actions.TemplatePromptGroup"
               description="Template Prompt" popup="true"
               text="Template Prompt"
               icon="/icons/icon_16px.svg">
            <add-to-group group-id="ProjectViewPopupMenu" anchor="first"/>
            <add-to-group group-id="Vcs.Log.ChangesBrowser.Popup" relative-to-action="Vcs.RepositoryChangesBrowserMenu"
                          anchor="first"/>
            <add-to-group group-id="Vcs.Log.ContextMenu" relative-to-action="Vcs.ShowDiffWithLocal" anchor="first"/>
            <add-to-group group-id="ConsoleEditorPopupMenu" anchor="first"/>
            <add-to-group group-id="EditorPopupMenu" anchor="first"/>
        </group>

        <action id="com.github.zjh7890.gpttools.actions.AddToSessionFileListAction"
                class="com.github.zjh7890.gpttools.actions.AddToSessionFileListAction"
                text="Add to Session File List"
                description="Add the current file to the session's file list."
                icon="/icons/icon_16px.svg">
            <add-to-group group-id="EditorPopupMenu" relative-to-action="PromptGeneratorGroup" anchor="after"/>
        </action>

        <action id="FindUsagesAcrossProjectsAction"
                class="com.github.zjh7890.gpttools.actions.FindUsagesAcrossProjectsAction"
                text="微服务 -Find Usages"
                description="Find Usages in other projects"
                icon="/icons/icon_16px.svg">
            <add-to-group group-id="EditorPopupMenu" relative-to-action="PromptGeneratorGroup" anchor="after"/>
        </action>

        <action id="FindImplAcrossProjectsAction"
                class="com.github.zjh7890.gpttools.actions.FindImplAcrossProjectsAction"
                text="微服务 -Find Impl"
                description="Find Impl in other projects"
                icon="/icons/icon_16px.svg">
            <add-to-group group-id="EditorPopupMenu" relative-to-action="PromptGeneratorGroup" anchor="after"/>
        </action>

        <action id="AddFileAction"
                class="com.github.zjh7890.gpttools.actions.AddFileAction"
                text="Add File to ToolWindow"
                description="Adds the selected file to the ToolWindow."
                icon="/icons/icon_16px.svg">
            <add-to-group group-id="EditorPopupMenu" relative-to-action="PromptGeneratorGroup" anchor="after"/>
        </action>

        <action id="AddToSessionFileListBatchAction"
                class="com.github.zjh7890.gpttools.actions.AddToSessionFileListBatchAction"
                text="Add to Session File List"
                description="Add selected files/directories to the session's file list."
                icon="/icons/icon_16px.svg">
            <add-to-group group-id="ProjectViewPopupMenu" relative-to-action="PromptGeneratorGroup" anchor="after"/>
        </action>

        <action id="AddRecursiveFileAction"
                class="com.github.zjh7890.gpttools.actions.AddRecursiveFileAction"
                text="Recursively Add Files to ToolWindow"
                description="Recursively adds files to the ToolWindow based on dependencies."
                icon="/icons/icon_16px.svg">
            <add-to-group group-id="EditorPopupMenu" relative-to-action="PromptGeneratorGroup" anchor="after"/>
        </action>

        <action id="ConvertToMermaid"
                class="com.github.zjh7890.gpttools.actions.ConvertToMermaidAction"
                text="ConvertToMermaid"
                description="ConvertToMermaid"
                icon="/icons/icon_16px.svg">
            <add-to-group group-id="EditorPopupMenu" relative-to-action="PromptGeneratorGroup" anchor="after"/>
        </action>

        <action id="PsiDependencyByMethodAction"
                class="com.github.zjh7890.gpttools.actions.PsiDependencyByMethodAction"
                text="PsiDependencyByMethodAction"
                description="PsiDependencyByMethodAction"
                icon="/icons/icon_16px.svg">
            <add-to-group group-id="EditorPopupMenu" relative-to-action="PromptGeneratorGroup" anchor="after"/>
        </action>

        <action id="CopyMethodSingleFile"
                class="com.github.zjh7890.gpttools.actions.CopyMethodSingleFile"
                text="CopyMethodSingleFile"
                description="CopyMethodSingleFile"
                icon="/icons/icon_16px.svg">
            <add-to-group group-id="EditorPopupMenu" relative-to-action="PromptGeneratorGroup" anchor="after"/>
        </action>

        <action id="AllMethodFile"
                class="com.github.zjh7890.gpttools.actions.AllMethodFile"
                text="AllMethodFile"
                description="AllMethodFile"
                icon="/icons/icon_16px.svg">
            <add-to-group group-id="EditorPopupMenu" relative-to-action="PromptGeneratorGroup" anchor="after"/>
        </action>

        
        <action id="OpenChatLogDirectoryAction"
                class="com.github.zjh7890.gpttools.actions.OpenChatLogDirectoryAction"
                text="gpt-tools 日志"
                description="gpt-tools 日志"
                icon="/icons/icon_16px.svg">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
        </action>

        <action id="ChatWithSelectedCodeAction"
                class="com.github.zjh7890.gpttools.actions.ChatWithSelectedCodeAction"
                text="Chat with selected code"
                description="Chat with selected code"
                icon="/icons/icon_16px.svg">
            <add-to-group group-id="Floating.CodeToolbar" anchor="first"/>
        </action>

        <action id="ReviewChangesAction"
                class="com.github.zjh7890.gpttools.actions.ReviewChangesAction"
                text="Ask AI to review selected changes"
                description="Ask AI to review  selected changes"
                icon="/icons/icon_16px.svg">
            <add-to-group group-id="ChangesViewToolbar" anchor="last"/>
            <add-to-group group-id="ChangesViewPopupMenu" relative-to-action="ChangesView.Revert" anchor="after"/>
        </action>
    </actions>
</idea-plugin>
